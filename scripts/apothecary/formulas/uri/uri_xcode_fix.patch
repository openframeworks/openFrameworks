diff --git a/src/detail/uri_parse.cpp b/src/detail/uri_parse.cpp
index 54ec59c..964e7d3 100644
--- a/src/detail/uri_parse.cpp
+++ b/src/detail/uri_parse.cpp
@@ -82,8 +82,12 @@ namespace network {
         ipvfuture %= qi::lit('v') >> +qi::xdigit >> '.' >>
                      +(unreserved | sub_delims | ':');
 
-        ipv6address %= qi::raw
-            [qi::repeat(6)[h16 >> ':'] >> ls32 |
+        qi::rule<const_iterator, string_type()> a;
+        qi::rule<const_iterator, string_type()> b;
+        qi::rule<const_iterator, string_type()> c;
+        qi::rule<const_iterator, string_type()> d;
+        
+        a = [qi::repeat(6)[h16 >> ':'] >> ls32 |
              "::" >> qi::repeat(5)[h16 >> ':'] >> ls32 |
              -qi::raw[h16] >> "::" >> qi::repeat(4)[h16 >> ':'] >> ls32 |
              -qi::raw[h16] >> "::" >> qi::repeat(3)[h16 >> ':'] >> ls32 |
@@ -96,20 +100,23 @@ namespace network {
              -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" >>
                  qi::repeat(2)[h16 >> ':'] >> ls32 |
              -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" >> h16 >>
-                 ':' >> ls32 |
-             -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
+                 ':' >> ls32;
+                 
+        b =  -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
              -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" >> h16 |
              -qi::raw[qi::repeat(1)[(h16 >> ':')] >> h16] >> "::" |
              -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" >>
                  qi::repeat(2)[h16 >> ':'] >> ls32 |
              -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" >> h16 >>
-                 ':' >> ls32 |
-             -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
+                 ':' >> ls32;
+                 
+        c =  -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
              -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" >> h16 |
              -qi::raw[qi::repeat(2)[(h16 >> ':')] >> h16] >> "::" |
              -qi::raw[qi::repeat(3)[(h16 >> ':')] >> h16] >> "::" >> h16 >>
-                 ':' >> ls32 |
-             -qi::raw[qi::repeat(3)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
+                 ':' >> ls32;
+
+        d =  -qi::raw[qi::repeat(3)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
              -qi::raw[qi::repeat(3)[(h16 >> ':')] >> h16] >> "::" >> h16 |
              -qi::raw[qi::repeat(3)[(h16 >> ':')] >> h16] >> "::" |
              -qi::raw[qi::repeat(4)[(h16 >> ':')] >> h16] >> "::" >> ls32 |
@@ -118,7 +125,7 @@ namespace network {
              -qi::raw[qi::repeat(5)[(h16 >> ':')] >> h16] >> "::" >> h16 |
              -qi::raw[qi::repeat(5)[(h16 >> ':')] >> h16] >> "::" |
              -qi::raw[qi::repeat(6)[(h16 >> ':')] >> h16] >> "::"];
-
+        ipv6address %= qi::raw[ a | b | c | d ];
         // ls32 = ( h16 ":" h16 ) / IPv4address
         ls32 %= (h16 >> ':' >> h16) | ipv4address;
 
